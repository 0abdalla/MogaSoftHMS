<main id="insurance-list" @fadeIn>
  
  <section class="section2" id="table-insurance">
    <div class="card mt-3 p-2">
      <div class="p-3 mt-4">
        <form [formGroup]="filterForm" (ngSubmit)="applyFilters()">
          <div class="row justify-content-between align-items-center g-2">
            <div class="col-lg-8 row">
              <div class="col-lg-2">
                <!-- <button type="submit" class="btn-blue w-100">ุชุทุจูู</button> -->
                <button type="button" (click)="resetFilters()" class="btn-cancel w-100">ุฅุธูุงุฑ ุงููู</button>
              </div>
              <div class="col-lg-4">
                <input
                  type="text"
                        class="form-control shadow-none"
                        placeholder="ุฃุฏุฎู ุฅุณู ุงูุดุฑูุฉ ุงูุชุฃููู"
                        formControlName="Search"
                      />
              </div>
            </div>
            <div class="col-lg-2">
              <button type="button" routerLink="/hms/insurance/add-insurance" class="btn-purble">+ ุฅุถุงูุฉ ุดุฑูุฉ ุชุฃููู</button>
            </div>
          </div>
        </form>
      </div>
        
      <table class="table table-hover mt-4">
        <thead>
          <tr>
            <th>ุงูุฅุณู</th>
            <th>ุงูุดุฑูุฉ</th>
            <th>ุฑูู ุงููุงุชู</th>
            <th>ุงูุจุฑูุฏ ุงูุงููุชุฑููู</th>
            <th>ุงูุญุงูุฉ</th>

            <!-- <th>ุงูุฅุฌุฑุงุกุงุช</th> -->
          </tr>
        </thead>
        <tbody *ngIf="insurnaces?.length > 0">
          <tr
                    *ngFor="let insurnace of insurnaces | paginate : { id: 'paginate', itemsPerPage: pageSize, currentPage: currentPage, totalItems: total }"
                    (click)="openInsuranceModal(insurnace.id)"
                    data-bs-toggle="modal"
                    data-bs-target="#insuranceModal"
                    style="cursor: pointer"
                  >
                    <td>
                      <div class="d-flex align-items-center gap-2 justify-content-start">
                        <!-- <div class="avatar-circle">{{ insurnace.fullName.charAt(0) }}</div> -->
                        <span class="fw-bold">{{ insurnace.name }}</span>
                      </div>
                    </td>
                    <td>
                      {{ insurnace.code }}
                    </td>
                    <td>
                      {{ insurnace.contactNumber }}
                    </td>
                    <td>
                      {{ insurnace.email }}
                    </td>
                    <td>
                        <span
                          class="status-pill"
                          [ngClass]="{
                            'bg-success': insurnace.isActive === true,
                            'bg-secondary': insurnace.isActive === false
                          }"
                        >
                          {{ insurnace.isActive ? 'ูุชุงุญ' : 'ุบูุฑ ูุชุงุญ' }}
                        </span>
                      </td>
                      
              
                    <!-- <td>
                      <button class="btn btn-outline-warning">
                        <i class="fa-light fa-pen-to-square"></i>
                      </button>
                    </td> -->
                  </tr>
                </tbody>
              
                <tbody *ngIf="insurnaces?.length === 0">
                  <tr>
                    <td colspan="6" class="text-center text-muted">ูุง ุชูุฌุฏ ุดุฑูุงุช ุชุฃููู ุญุชู ุงูุขู</td>
                  </tr>
                </tbody>
            </table>
            
        
            <div class="col-lg-12">
              <div
                *ngIf="total > 16"
                class="pagination-container my-0 px-3 d-flex justify-content-center align-items-center"
              >
                <div class="my-pagination">
                  <pagination-controls
                    id="paginate"
                    (pageChange)="onPageChange($event)"
                    (pageBoundsCorrection)="onPageChange($event)"
                    [maxSize]="16"
                    [directionLinks]="true"
                    [autoHide]="true"
                    [responsive]="true"
                    previousLabel=""
                    nextLabel=""
                    screenReaderPageLabel="page"
                    screenReaderCurrentLabel="You're on page"
                  >
                  </pagination-controls>
                </div>
              </div>
            </div>
          </div>
  </section>
</main>


<div class="modal fade" id="insuranceModal" tabindex="-1" aria-labelledby="insuranceLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <img src="assets/vendors/imgs/pattern.png" alt="" class="img-fluid">

      <div id="pdfContent" class="print-section">
        <div class="modal-header justify-content-center text-center">
          <h5 class="text-center modal-title" id="insuranceLabel">ุชูุงุตูู ุดุฑูุฉ ุงูุชุฃููู</h5>
        </div>

        <div class="modal-body p-4">
          <h4 class="mb-3">๐ขุจูุงูุงุช ุงูุดุฑูุฉ</h4>
          <div class="row mb-3">
            <div class="col-lg-4">
              <strong class="strong">ุงูุงุณู:</strong> <span class="span"> {{ selectedInsurance?.name }}</span> 
            </div>
            <div class="col-lg-4">
              <strong class="strong">ุงูููุฏ:</strong> <span class="span"> {{ selectedInsurance?.code }}</span>
            </div>
            <div class="col-lg-4">
              <strong class="strong">ุงูุญุงูุฉ:</strong> <span class="span"> {{ selectedInsurance?.isActive === true ? 'ูุชุงุญ' : 'ุบูุฑ ูุชุงุญ' }}</span>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-lg-4">
              <strong class="strong">ุฑูู ุงูุชูุงุตู:</strong> <span class="span"> {{ selectedInsurance?.contactNumber }}</span>
            </div>
            <div class="col-lg-4">
              <strong class="strong">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</strong> <span class="span"> {{ selectedInsurance?.email }}</span>
            </div>
            <div class="col-lg-4">
              <strong class="strong">ุนุฏุฏ ุงูุญุงูุงุช ุงููุนุงูุฌุฉ:</strong> <span class="span"> {{ selectedInsurance?.processedClaimsCount }}</span>
            </div>
          </div>

          <div class="row mb-3">
            <div class="col-lg-6">
              <strong class="strong">ุฅุฌูุงูู ุงููุจูุบ ุงููุณุชุญู ูู ุงูุดุฑูุฉ:</strong> <span class="span"> {{ selectedInsurance?.totalAmountDue || 'ุบูุฑ ูุฐููุฑ' }}</span>
            </div>
          </div>

          <hr>

          <h4 class="mb-3">๐ุชูุงุตูู ุงูุนูุฏ</h4>
          <div class="row mb-3">
            <div class="col-lg-4">
              <strong class="strong">ุชุงุฑูุฎ ุงูุชุณุฌูู:</strong> <span class="span"> {{ selectedInsurance?.registrationDate | date: 'yyyy-MM-dd' }}</span>
            </div>
            <div class="col-lg-4">
              <strong class="strong">ุชุงุฑูุฎ ุงูุจุฏุก:</strong> <span class="span"> {{ selectedInsurance?.contractStartDate | date: 'yyyy-MM-dd' }}</span>
            </div>
            <div class="col-lg-4">
              <strong class="strong">ุชุงุฑูุฎ ุงูุงูุชูุงุก:</strong> <span class="span"> {{ selectedInsurance?.contractEndDate | date: 'yyyy-MM-dd' }}</span>
            </div>
          </div>

          <hr>

          <h4 class="mb-3">๐ฐูุฆุงุช ุงูุชุบุทูุฉ</h4>
          <div class="row mb-3" *ngFor="let category of selectedInsurance?.insuranceCategories">
            <div class="col-lg-4">
              <strong class="strong">{{ category.name }}:</strong> <span class="span">ุชุบุทู {{ category.rate }}% ูู ุชูููุฉ ุงูุนูุงุฌ</span>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer row">
        <div class="col-3 m-0">
          <button (click)="editInsurance(selectedInsurance.id)" class="btn col-12 btn-outline-warning">ุชุนุฏูู ุงูุจูุงูุงุช</button>
        </div>
        <div class="col-3 m-0">
          <button class="btn col-12 btn-outline-info">ุนููุฏ ุณุงุจูุฉ</button>
        </div>
        <div class="col-3 m-0">
          <button class="btn col-12 btn-outline-primary" (click)="print()">ุทุจุงุนุฉ</button>
        </div>
        <div class="col-3 m-0">
          <button class="btn col-12 btn-outline-success" (click)="exportToPDF()">ุชุญููู ุฅูู PDF</button>
        </div>
      </div>

    </div>
  </div>
</div>
