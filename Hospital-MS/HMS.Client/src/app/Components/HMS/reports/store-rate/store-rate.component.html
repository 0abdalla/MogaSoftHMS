<main id="store-rate-report">
    <h4>تقرير تقييم المخزون</h4>
    <form class="form p-2 row" [formGroup]="storeRateForm" (ngSubmit)="showStoreRateReport()">
        <div class="col-lg-4">
            <div class="mb-2">
                <label class="form-label">اسم المخزن</label>
                <ng-select
                    [items]="stores"
                    bindLabel="name"
                    bindValue="id"
                    placeholder="اختر المخزن"
                    formControlName="storeId"
                    class="text-end shadow-none w-100"
                    [searchable]="true">
                </ng-select>
                <div *ngIf="storeRateForm.get('storeId')?.invalid && storeRateForm.get('storeId')?.touched" class="text-danger">
                    اسم المخزن مطلوب
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <label class="form-label">التاريخ من</label>
            <input type="date" class="form-control shadow-none" formControlName="fromDate">
            <div *ngIf="storeRateForm.get('fromDate')?.invalid && storeRateForm.get('fromDate')?.touched" class="text-danger">
                    بداية التاريخ مطلوبة
                </div>
        </div>
        <div class="col-lg-4">
            <label class="form-label">التاريخ إلى</label>
            <input type="date" class="form-control shadow-none" formControlName="toDate">
            <div *ngIf="storeRateForm.get('toDate')?.invalid && storeRateForm.get('toDate')?.touched" class="text-danger">
                    نهاية التاريخ مطلوبة
                </div>
        </div>
        <div class="row">
            <div class="col-lg-6">
                <button type="submit" class="btn-blue">تأكيد</button>
            </div>
            <div class="col-lg-6">
                <button type="reset" class="btn-red">إلغاء</button>
            </div>
        </div>
    </form>
</main>



<div class="modal fade" id="storeRateReport" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        
        <div class="modal-header">
          <h5 class="modal-title">
            تقييم المخزون - مخزن {{ selectedStoreName }}
            <small>من {{ selectedFromDate }} إلى {{ selectedToDate }}</small>
          </h5>
        </div>
  
        <div class="modal-body">
  
          <div *ngFor="let group of storeRateData">
            <h6 class="mt-3">المجموعة: {{ group.itemGroupName }}</h6>
            
            <table class="table table-bordered table-hover">
              <thead class="table-primary">
                <tr>
                  <th>رقم الصنف</th>
                  <th>اسم الصنف</th>
                  <th>رصيد الصنف</th>
                  <th>القيمة الإجمالية</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of group.items"
                    [ngClass]="{
                      'table-danger': item.balance < 10,
                      'table-warning': item.balance >= 10 && item.balance <= 50
                    }">
                  <td>{{ item.itemId }}</td>
                  <td>{{ item.itemName }}</td>
                  <td>{{ item.balance }}</td>
                  <td>{{ item.totalAmount | number:'1.0-2' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
  
        </div>
  
      </div>
    </div>
  </div>
  