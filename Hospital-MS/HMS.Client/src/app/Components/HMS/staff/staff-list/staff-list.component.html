<main id="staff-list" @fadeIn>
    <section class="section2" id="table-employees">
        <app-breadcrumb [TitleList]="TitleList"></app-breadcrumb>
        <div class="card p-2">
            <div class="align-items-center border-bottom d-flex flex-wrap justify-content-between p-3 table-card-title bg-light">
                <div class="col-md-8 mb-2">
                    <div class="d-flex align-items-center gap-2">
                        <button class="btn btn-success d-flex align-items-center gap-2 border rounded px-3" routerLink="/hms/staff/add">
                    <i class="fas fa-plus-circle"></i>
                    <span>ุฅุถุงูุฉ ููุธู</span>
                </button>
                        <button class="btn btn-success d-flex align-items-center gap-2 border rounded px-3" (click)="isFilter = !isFilter" [attr.aria-expanded]="!isFilter">
                    <i class="uil uil-filter"></i>
                    <span class="navbar-brand m-0">{{ isFilter ? 'ุนุฑุถ' : 'ุงุฎูุงุก' }} ุงูููุงุชุฑ</span>
                </button>
                    </div>
                </div>
                <!-- <div class="col-md-4 mb-2" *ngIf="total > 0">
                    <app-pagination (pageChanged)="onPageChange($event)" [currentPage]="pagingFilterModel.currentPage" [pageSize]="pagingFilterModel.pageSize" [totalCount]="total"></app-pagination>
                </div> -->
                <div class="col-md-12 mt-3" #collapse="ngbCollapse" [(ngbCollapse)]="isFilter">
                    <div class="d-flex align-items-center">
                        <ng-container>
                            <app-filters [showSelector]="false" [searchPlaceholder]="'ุฃุฏุฎู ุฅุณู ุงูููุธู ...'" [categoryName]="'Status'" (filterChanged)="applyFilters($event)"></app-filters>
                        </ng-container>
                    </div>
                </div>
            </div>
            <table class="table table-hover mt-4">
                <thead>
                    <tr>
                        <th>ุงูุฅุณู</th>
                        <th>ุงููุธููุฉ</th>
                        <th>ุชุงุฑูุฎ ุงูุชุนููู</th>
                        <th>ุงูุญุงูุฉ</th>
                    </tr>
                </thead>
                <tbody *ngIf="employees && employees.length > 0; else noData">
                    <tr *ngFor="let employee of employees | paginate : { id: 'paginate', itemsPerPage: pageSize, currentPage: currentPage, totalItems: total }" (click)="openStaffModal(employee.id)" data-bs-toggle="modal" data-bs-target="#employeeDetailsModal" style="cursor: pointer">
                        <td>
                            <div class="d-flex align-items-center gap-2 justify-content-start">
                                <div class="avatar-circle">{{ employee.fullName.charAt(0) }}</div>
                                <span class="fw-bold">{{ employee.fullName }}</span>
                            </div>
                        </td>
                        <td>
                            {{ employee.jobTitleName || 'ุบูุฑ ูุญุฏุฏ' }}
                        </td>
                        <td class="text-secondary fw-semibold">
                            {{ employee.hireDate | date: 'yyyy/MM/dd' }}
                        </td>
                        <td>
                            <span [ngClass]="{
                  'text-success': employee.status === 'ูุชุงุญ',
                  'text-secondary': employee.status !== 'ูุชุงุญ'
                }">
                  {{ employee.status }}
                </span>
                        </td>
                    </tr>
                </tbody>
                <ng-template #noData>
                    <tbody>
                        <tr>
                            <td colspan="4" class="text-center text-muted">ูุง ููุฌุฏ ููุธููู ุญุชู ุงูุขู</td>
                        </tr>
                    </tbody>
                </ng-template>
            </table>

            <div class="col-lg-12" *ngIf="total > pageSize">
                <div class="pagination-container my-0 px-3 d-flex justify-content-center align-items-center">
                    <div class="my-pagination">
                        <pagination-controls id="paginate" (pageChange)="onPageChange($event)" (pageBoundsCorrection)="onPageChange($event)" [maxSize]="16" [directionLinks]="true" [autoHide]="true" [responsive]="true" previousLabel="" nextLabel="" screenReaderPageLabel="page"
                            screenReaderCurrentLabel="You're on page"></pagination-controls>
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>



<div class="modal fade" id="employeeDetailsModal" tabindex="-1" aria-labelledby="employeeDetailsLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <img src="assets/vendors/imgs/pattern.png" alt="" class="img-fluid">

            <div #employeeDetailsPDF>
                <div class="modal-header justify-content-center">
                    <h5 class="modal-title" id="employeeDetailsLabel">ุชูุงุตูู ุงูููุธู</h5>
                </div>
    
                <div class="modal-body p-4">
                    <h4>๐ค ุงูุจูุงูุงุช ุงูุดุฎุตูุฉ</h4>
                    <div class="row mb-3">
                        <div class="col-lg-4">
                            <strong>ุงูุฅุณู ุงููุงูู:</strong> <span>{{ selectedEmployee?.fullName || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงูุฑูู ุงููููู:</strong> <span>{{ selectedEmployee?.nationalId || '---' }}</span>
                        </div>
    
                        <div class="col-lg-4">
                            <strong>ุงูููุน:</strong> <span>{{ selectedEmployee?.gender || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงูุญุงูุฉ ุงูุงุฌุชูุงุนูุฉ:</strong> <span>{{ selectedEmployee?.maritalStatus || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุชุงุฑูุฎ ุงููููุงุฏ:</strong> <span>{{ selectedEmployee?.dateOfBirth || '---' }}</span>
                        </div>
    
                    </div>
    
                    <hr>
    
                    <h4>๐ผ ูุนูููุงุช ุงููุธููุฉ</h4>
                    <div class="row mb-3">
                        <div class="col-lg-4">
                            <strong>ุงููุณูู ุงููุธููู:</strong> <span>{{ selectedEmployee?.jobTitleName || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงููุณู:</strong> <span>{{ selectedEmployee?.jobDepartmentName || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงููุฑุน:</strong> <span>{{ selectedEmployee?.branchName || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุชุงุฑูุฎ ุงูุชุนููู:</strong> <span>{{ selectedEmployee?.hireDate || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงูุญุงูุฉ:</strong> <span> {{ selectedEmployee?.status || '---' }} </span>
                        </div>
                    </div>
    
                    <hr>
    
                    <h4>๐ ูุนูููุงุช ุงูุงุชุตุงู</h4>
                    <div class="row mb-3">
                        <div class="col-lg-4">
                            <strong>ุฑูู ุงููุงุชู:</strong> <span>{{ selectedEmployee?.phoneNumber || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</strong> <span>{{ selectedEmployee?.email || '---' }}</span>
                        </div>
                        <div class="col-lg-4">
                            <strong>ุงูุนููุงู:</strong> <span>{{ selectedEmployee?.address || '---' }}</span>
                        </div>
                    </div>
                    <hr>
                    <h4>๐ฐุจูุงูุงุช ุงููุฑุชุจ</h4>
                    <div class="row mb-3">
                        <div class="col-lg-3">
                          <strong>ุงููุฑุชุจ ุงูุฃุณุงุณู:</strong>
                          <span>{{ selectedEmployee?.basicSalary | number : '1.2-2' }} ุฌููู</span>
                        </div>
                        <div class="col-lg-3">
                          <strong>ุงูุจุฏูุงุช:</strong>
                          <span>{{ selectedEmployee?.allowances | number : '1.2-2' }} ุฌููู</span>
                        </div>
                        <div class="col-lg-3">
                          <strong>ุงูุฎุตููุงุช:</strong>
                          <span>{{ selectedEmployee?.deductions | number : '1.2-2' }} ุฌููู</span>
                        </div>
                        <div class="col-lg-3">
                          <strong>ุตุงูู ุงููุฑุชุจ:</strong>
                          <span>{{ selectedEmployee?.netSalary | number : '1.2-2' }} ุฌููู</span>
                        </div>
                      </div>                      
    
                    <hr>
    
                    <h4>๐ ููุงุญุธุงุช</h4>
                    <p class="text-muted">{{ selectedEmployee?.notes || 'ูุง ููุฌุฏ ููุงุญุธุงุช' }}</p>
                </div>
            </div>

            <div class="modal-footer row">
                <div class="col-4 m-0">
                    <button class="btn col-12 btn-outline-warning" (click)="editEmployee()">ุชุนุฏูู ุงูุจูุงูุงุช</button>
                </div>
                <!-- <div class="col-4 m-0">
                    <button class="btn col-12 btn-outline-info" (click)="print()">ุทุจุงุนุฉ</button>
                </div> -->
                <div class="col-4 m-0">
                    <button class="btn col-12 btn-outline-primary" (click)="exportToPDF()">ุชุญููู ุฅูู PDF</button>
                </div>
                <div class="col-4 m-0">
                    <button class="btn col-12 btn-outline-primary" (click)="suspendEmployee()">ุชุนููู ูุคูุช</button>
                </div>
            </div>
        </div>
    </div>
</div>