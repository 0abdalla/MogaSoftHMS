<main id="add-reservation" @fadeIn>
  <div class="container-fluid">
    <form [formGroup]="reservationForm" class="form p-2" (ngSubmit)="onSubmit()">
      <p-toast position="top-left"></p-toast>
      <h4>๐คุจูุงูุงุช ุงููุฑูุถ</h4>
      <div class="row mb-3">
        <div class="col-lg-6">
          <label for="patientName" class="form-label">ุฅุณู ุงููุฑูุถ</label>
          <input type="text" id="patientName" class="form-control shadow-none" placeholder="ุฃุฏุฎู ุฅุณู ุงููุฑูุถ" formControlName="patientName">
        </div>
        <div class="col-lg-6">
          <label for="patientPhone" class="form-label">ุฑูู ูุงุชู ุงููุฑูุถ</label>
          <input type="text" id="patientPhone" class="form-control shadow-none" placeholder="ุฃุฏุฎู ุฑูู ูุงุชู ุงููุฑูุถ" formControlName="patientPhone">
        </div>
      </div>
      <hr>
      <h4>๐ฅุจูุงูุงุช ุงูุญุฌุฒ</h4>
      <div class="row mb-3">
        <div class="col-lg-3">
          <label for="app-date" class="form-label">ุชุงุฑูุฎ ุงูุญุฌุฒ</label>
          <input id="app-date" type="datetime-local" formControlName="appointmentDate" class="form-control shadow-none">
        </div>
        <div class="col-lg-3">
          <label for="clinic-type" class="form-label">ููุน ุงูุญุฌุฒ</label>
          <select id="clinic-type" class="form-select shadow-none" formControlName="appointmentType">
            <option selected disabled value="">ุงุฎุชุฑ ููุน ุงูุญุฌุฒ</option>
            <option value="General">ูุดู</option>
            <option value="Consultation">ุงุณุชุดุงุฑุฉ</option>
            <option value="Surgery">ุนูููุงุช</option>
            <option value="Screening">ุชุญุงููู</option>
            <option value="Radiology">ุฃุดุนุฉ</option>
          </select>
        </div>
        <div class="col-lg-3">
          <label for="clinic" class="form-label">ุงูุฎุฏูุฉ ุงูุทุจูุฉ</label>
          <select id="clinic" class="form-select shadow-none" formControlName="clinicId">
            <option selected disabled value="">ุงุฎุชุฑ ุงูุฎุฏูุฉ</option>
            <option *ngFor="let clinic of filteredClinics" [value]="clinic.id">{{ clinic.name }}</option>
          </select>
        </div>
        <div class="col-lg-3" *ngIf="selectedAppointmentType !== 'Screening'">
          <label for="clinic-doctor" class="form-label">
            {{ selectedAppointmentType === 'Radiology' ? 'ููุน ุงูุฃุดุนุฉ' : 'ุงูุฏูุชูุฑ ุงููุฎุชุต' }}
          </label>
          <select id="clinic-doctor" class="form-select shadow-none" 
                  [formControlName]="selectedAppointmentType === 'Radiology' ? 'radiologyType' : 'doctorId'">
            <option selected disabled value="">
              {{ selectedAppointmentType === 'Radiology' ? 'ุงุฎุชุฑ ููุน ุงูุฃุดุนุฉ' : 'ุงุฎุชุฑ ุงูุฏูุชูุฑ ุงููุฎุชุต' }}
            </option>
        
            <ng-container *ngIf="selectedAppointmentType === 'Radiology'">
              <option *ngFor="let type of radiologyTypes" [value]="type">{{ type }}</option>
            </ng-container>
        
            <ng-container *ngIf="selectedAppointmentType !== 'Radiology'">
              <option *ngFor="let doctor of filteredDoctors" [value]="doctor.id">{{ doctor.fullName }}</option>
            </ng-container>
          </select>
        </div>
        
      </div>
      <hr>
      <h4>๐ุจูุงูุงุช ุฅุถุงููุฉ</h4>
      <div class="row mb-3">
        <div class="col-lg-4">
          <label for="insuranceCompanyId" class="form-label">ุดุฑูุฉ ุงูุชุฃููู</label>
          <select id="insuranceCompanyId" class="form-select shadow-none" formControlName="insuranceCompanyId">
            <option selected disabled value="">ุงุฎุชุฑ ุดุฑูุฉ ุงูุชุฃููู</option>
            <option value="ุดุฑูุฉ 1">ุดุฑูุฉ 1</option>
            <option value="ุดุฑูุฉ 2">ุดุฑูุฉ 2</option>
          </select>
        </div>
        <div class="col-lg-4">
          <label for="insuranceCategoryId" class="form-label">ูุฆุฉ ุงูุชุฃููู</label>
          <select id="insuranceCategoryId" class="form-select shadow-none" formControlName="insuranceCategoryId">
            <option selected disabled value="">ุงุฎุชุฑ ูุฆุฉ ุงูุชุฃููู</option>
            <option value="ูุฆุฉ 1">ูุฆุฉ 1</option>
            <option value="ูุฆุฉ 2">ูุฆุฉ 2</option>
          </select>
        </div>
        <div class="col-lg-4">
          <label for="insuranceNumber" class="form-label">ุฑูู ุงูุชุฃููู</label>
          <input type="text" id="insuranceNumber" class="form-control shadow-none" formControlName="insuranceNumber" placeholder="ุฃุฏุฎู ุฑูู ุงูุชุฃููู"
            pattern="[0-9]*">
        </div>
      
        <div class="col-lg-4 mt-3">
          <label class="form-label">ุชู ุชุญููููุ</label>
          <div class="form-check">
            <input type="radio" id="referredYes" class="form-check-input shadow-none" formControlName="referred" value="yes">
            <label for="referredYes" class="form-check-label">ูุนู</label>
          </div>
          <div class="form-check">
            <input type="radio" id="referredNo" class="form-check-input shadow-none" formControlName="referred" value="no">
            <label for="referredNo" class="form-check-label">ูุง</label>
          </div>
        </div>
        <div class="col-lg-4 mt-3" *ngIf="reservationForm.get('referred')?.value === 'yes'">
          <label for="referredClinic" class="form-label">ุงูุนูุงุฏุฉ ุงููุญูู ูููุง</label>
          <select [disabled]="!reservationForm.get('referred')?.value" id="referredClinic" class="form-select shadow-none" formControlName="referredClinic">
            <option selected disabled value="">ุงุฎุชุฑ ุงูุนูุงุฏุฉ</option>
            <option value="ุนูุงุฏุฉ ุงูุนุธุงู">ุนูุงุฏุฉ ุงูุนุธุงู</option>
            <option value="ุนูุงุฏุฉ ุงูุจุงุทูุฉ">ุนูุงุฏุฉ ุงูุจุงุทูุฉ</option>
          </select>
        </div>
        <!-- <div class="col-lg-4 mt-3">
          <label class="form-label">ุญุงุตู ุนูู ุชุทุนููุ</label>
          <div class="form-check">
            <input type="radio" id="vaccinatedYes" class="form-check-input shadow-none" formControlName="vaccinated" value="yes">
            <label for="vaccinatedYes" class="form-check-label">ูุนู</label>
          </div>
          <div class="form-check">
            <input type="radio" id="vaccinatedNo" class="form-check-input shadow-none" formControlName="vaccinated" value="no">
            <label for="vaccinatedNo" class="form-check-label">ูุง</label>
          </div>
        </div> -->
        <div class="col-lg-4 mt-3">
          <label for="paymentMethod" class="form-label">ูุณููุฉ ุงูุฏูุน</label>
          <select id="paymentMethod" class="form-select shadow-none" formControlName="paymentMethod">
            <option selected disabled value="">ุงุฎุชุฑ ูุณููุฉ ุงูุฏูุน</option>
            <option value="Cash">ููุฏู</option>
            <option value="Instapay">ุชุญููู ูุญุธู</option>
          </select>
        </div>
      </div>
      <div class="row justify-content-center gap-2 px-3">
          <button type="submit" [disabled]="!reservationForm.valid" class="btn-blue col-2">ุฅุถุงูุฉ</button>
          <button type="reset" class="btn-outline-blue col-2">ุงูุบุงุก</button>
        
      </div>
    </form>
  </div>
</main>


<div *ngIf="showReceipt" class="receipt-container" id="receipt">
  <div class="receipt">
    <div class="receipt-header">
      <img src="assets/images/company-logo.png" alt="Company Logo" class="company-logo" />
      <h2>ุฅูุตุงู ุงูุญุฌุฒ</h2>
      <p>ุดุฑูุฉ ุงูุฑุนุงูุฉ ุงูุตุญูุฉ</p>
      <p>ุชุงุฑูุฎ ุงูุญุฌุฒ: {{ submittedData.appointmentDate | date: 'dd/MM/yyyy HH:mm' }}</p>
    </div>
    <hr />
    <div class="receipt-body">
      <h4>๐ค ุจูุงูุงุช ุงููุฑูุถ</h4>
      <p><strong>ุงูุงุณู:</strong> {{ submittedData.patientName }}</p>
      <p><strong>ุฑูู ุงููุงุชู:</strong> {{ submittedData.patientPhone }}</p>

      <h4>๐ฅ ุจูุงูุงุช ุงูุญุฌุฒ</h4>
      <p><strong>ุชุงุฑูุฎ ุงูุญุฌุฒ:</strong> {{ submittedData.appointmentDate | date: 'dd/MM/yyyy HH:mm' }}</p>
      <p><strong>ููุน ุงูุญุฌุฒ:</strong> {{ submittedData.appointmentType }}</p>
      <p><strong>ุงูุฎุฏูุฉ ุงูุทุจูุฉ:</strong> {{ getClinicName(submittedData.clinicId) }}</p>
      <p *ngIf="submittedData.appointmentType === 'Radiology'"><strong>ููุน ุงูุฃุดุนุฉ:</strong> {{ submittedData.radiologyType }}</p>
      <p *ngIf="submittedData.appointmentType !== 'Radiology' && submittedData.doctorId"><strong>ุงูุฏูุชูุฑ ุงููุฎุชุต:</strong> {{ getDoctorName(submittedData.doctorId) }}</p>

      <h4>๐ ุจูุงูุงุช ุฅุถุงููุฉ</h4>
      <p><strong>ุดุฑูุฉ ุงูุชุฃููู:</strong> {{ submittedData.insuranceCompanyId || 'ุบูุฑ ูุญุฏุฏ' }}</p>
      <p><strong>ูุฆุฉ ุงูุชุฃููู:</strong> {{ submittedData.insuranceCategoryId || 'ุบูุฑ ูุญุฏุฏ' }}</p>
      <p><strong>ุฑูู ุงูุชุฃููู:</strong> {{ submittedData.insuranceNumber || 'ุบูุฑ ูุญุฏุฏ' }}</p>
      <p><strong>ุชู ุชุญููููุ:</strong> {{ submittedData.referred === 'yes' ? 'ูุนู' : 'ูุง' }}</p>
      <p *ngIf="submittedData.referred === 'yes'"><strong>ุงูุนูุงุฏุฉ ุงููุญูู ูููุง:</strong> {{ submittedData.referredClinic }}</p>
      <p><strong>ูุณููุฉ ุงูุฏูุน:</strong> {{ submittedData.paymentMethod }}</p>
    </div>
    <hr />
    <div class="receipt-footer">
      <p>ุดูุฑุงู ูุงุฎุชูุงุฑูู ุฎุฏูุงุชูุง</p>
      <p>ููุชูุงุตู: info&#64;healthcare.com | 1234-567-890</p>
    </div>
  </div>
  <div class="receipt-actions">
    <button class="btn-blue" (click)="printReceipt()">ุทุจุงุนุฉ ุงูุฅูุตุงู</button>
    <button class="btn-outline-blue" (click)="closeReceipt()">ุฅุบูุงู</button>
  </div>
</div>